<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Recorder - AI Game Bot</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-robot me-2"></i>AI Game Bot - Task Recorder
            </a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="/">Dashboard</a>
                <a class="nav-link" href="/item_mapper">Item Mapper</a>
                <a class="nav-link" href="/multi_instance_launcher">Multi-Instance</a>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <div class="row">
            <!-- Recording Control Panel -->
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header">
                        <h5><i class="fas fa-record-vinyl me-2"></i>Task Recording</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="taskName" class="form-label">Task Name</label>
                            <input type="text" class="form-control" id="taskName" placeholder="Enter task name (e.g., 'Open 10 Chests')">
                        </div>
                        <div class="mb-3">
                            <label for="taskDescription" class="form-label">Task Description</label>
                            <textarea class="form-control" id="taskDescription" rows="3" 
                                    placeholder="Describe what this task does (e.g., 'Clicks chest locations and collects rewards')"></textarea>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button class="btn btn-success" id="startTaskRecording">
                                <i class="fas fa-play me-2"></i>Start Recording Task
                            </button>
                            <button class="btn btn-danger" id="stopTaskRecording" disabled>
                                <i class="fas fa-stop me-2"></i>Stop Recording
                            </button>
                        </div>
                        
                        <div class="mt-3">
                            <div class="alert alert-info" id="recordingStatus" style="display: none;">
                                <i class="fas fa-info-circle me-2"></i>
                                <span id="statusMessage">Ready to record</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Live Recording Info -->
                <div class="card mb-4" id="recordingInfo" style="display: none;">
                    <div class="card-header">
                        <h6><i class="fas fa-clock me-2"></i>Recording in Progress</h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-6">
                                <div class="text-center">
                                    <h4 id="recordingDuration" class="text-primary">00:00</h4>
                                    <small class="text-muted">Duration</small>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="text-center">
                                    <h4 id="actionCount" class="text-success">0</h4>
                                    <small class="text-muted">Actions Recorded</small>
                                </div>
                            </div>
                        </div>
                        <div class="progress mt-3">
                            <div class="progress-bar progress-bar-striped progress-bar-animated" 
                                 id="recordingProgress" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Export Options -->
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header">
                        <h5><i class="fas fa-download me-2"></i>Export Recorded Tasks</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="taskSelect" class="form-label">Select Task to Export</label>
                            <select class="form-select" id="taskSelect">
                                <option value="">Choose a recorded task...</option>
                            </select>
                        </div>
                        
                        <div class="mb-3" id="exportFormats" style="display: none;">
                            <label class="form-label">Export Format</label>
                            <div class="btn-group-vertical w-100" role="group">
                                <button type="button" class="btn btn-outline-primary export-btn" data-format="json">
                                    <i class="fas fa-file-code me-2"></i>JSON Format
                                    <small class="d-block text-muted">Raw macro data for import</small>
                                </button>
                                <button type="button" class="btn btn-outline-success export-btn" data-format="python">
                                    <i class="fab fa-python me-2"></i>Python Script
                                    <small class="d-block text-muted">Executable Python automation</small>
                                </button>
                                <button type="button" class="btn btn-outline-warning export-btn" data-format="javascript">
                                    <i class="fab fa-js-square me-2"></i>JavaScript
                                    <small class="d-block text-muted">Browser automation script</small>
                                </button>
                                <button type="button" class="btn btn-outline-info export-btn" data-format="ahk">
                                    <i class="fas fa-keyboard me-2"></i>AutoHotkey v1
                                    <small class="d-block text-muted">Classic AHK automation script</small>
                                </button>
                                <button type="button" class="btn btn-outline-secondary export-btn" data-format="ahk2">
                                    <i class="fas fa-keyboard me-2"></i>AutoHotkey v2
                                    <small class="d-block text-muted">Modern AHK v2 automation script</small>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Code Preview -->
                <div class="card mb-4" id="codePreview" style="display: none;">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h6><i class="fas fa-eye me-2"></i>Code Preview</h6>
                        <button class="btn btn-sm btn-success" id="downloadFile">
                            <i class="fas fa-download me-1"></i>Download
                        </button>
                    </div>
                    <div class="card-body">
                        <pre><code id="codeContent" class="language-javascript"></code></pre>
                        <div class="mt-2">
                            <small class="text-muted">
                                <i class="fas fa-info-circle me-1"></i>
                                File: <span id="fileName">macro.js</span> | 
                                Size: <span id="fileSize">0</span> bytes
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Recorded Tasks List -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5><i class="fas fa-list me-2"></i>Recorded Tasks</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped" id="tasksTable">
                                <thead>
                                    <tr>
                                        <th>Task Name</th>
                                        <th>Description</th>
                                        <th>Actions</th>
                                        <th>Duration</th>
                                        <th>Created</th>
                                        <th>Export Options</th>
                                    </tr>
                                </thead>
                                <tbody id="tasksTableBody">
                                    <!-- Tasks will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='task_recorder.js') }}"></script>
</body>
</html>